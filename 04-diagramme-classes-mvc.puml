@startuml Diagramme_Classes_MVC
title Diagramme de Classes MVC - Système d'Évaluation des Enseignants
skinparam classBackgroundColor #F0F0F0
skinparam classBorderColor #333
skinparam packageBackgroundColor #E8E8E8

package "Model" {
    class Utilisateur {
        - id: int
        - nom: string
        - prenom: string
        - email: string
        - motDePasse: string
        - role: Role
        - dateCreation: Date
        --
        + authentifier(): boolean
        + obtenirProfil(): Utilisateur
        + mettreAJourProfil(): void
    }

    class Etudiant {
        - niveauEtude: string
        - departement: string
        --
        + remplirEvaluation(): void
        + consulterCommentaires(): void
    }

    class Enseignant {
        - specialite: string
        - departement: string
        - dateEmbauche: Date
        --
        + consulterEvaluations(): List<Evaluation>
        + repondreAuxCommentaires(): void
        + obtenirMoyenneGlobale(): float
    }

    class Administrateur {
        - permissionLevel: int
        - dateNomination: Date
        --
        + creerFormulaire(): void
        + gererUtilisateurs(): void
        + genererRapports(): void
        + configureAnonyme(): void
    }

    class Formulaire {
        - id: int
        - titre: string
        - description: string
        - enseignant: Enseignant
        - dateCreation: Date
        - dateExpiration: Date
        - estActif: boolean
        --
        + ajouterQuestion(): void
        + supprimerQuestion(): void
        + obtenirQuestions(): List<Question>
    }

    class ModeleFormulaire {
        --
        + obtenirFormulaireActif(enseignantID: int): Formulaire
        + obtenirQuestions(formulaireID: int): List<Question>
        + verifierDisponibilite(formulaireID: int): boolean
        + estExpire(formulaireID: int): boolean
    }

    class Question {
        - id: int
        - texte: string
        - type: TypeQuestion
        - ordreAffichage: int
        - estObligatoire: boolean
        --
        + validerReponse(contenu: string): boolean
        + obtenirOptions(): List<string>
    }

    class Evaluation {
        - id: int
        - formulaire: Formulaire
        - etudiant: Etudiant
        - dateDebut: Date
        - dateSoumission: Date
        - statut: StatutEvaluation
        - anonyme: boolean
        --
        + sauvegarder(): void
        + soumettre(): void
    }

    class ModeleEvaluation {
        --
        + verifierEvaluationExistante(etudiantID: int, formulaireID: int): boolean
        + validerReponses(reponses: Map, formulaireID: int): ValidationResult
        + creerEvaluation(etudiantID: int, formulaireID: int): Evaluation
        + enregistrerReponse(evaluationID: int, questionID: int, contenu: string): void
        + finaliserEvaluation(evaluationID: int): void
        + obtenirNombreEvaluations(): int
        + obtenirEvaluationsDetaillees(): List<Evaluation>
    }

    class Reponse {
        - id: int
        - evaluation: Evaluation
        - question: Question
        - contenu: string
        - score: int
        --
        + enregistrer(): void
        + valider(): boolean
    }

    class Brouillon {
        - id: int
        - etudiant: Etudiant
        - formulaire: Formulaire
        - reponsesPartielles: Map<Question, string>
        - dateModification: Date
        --
        + sauvegarder(): void
        + charger(): Map<Question, string>
    }

    class ModeleBrouillon {
        --
        + obtenirBrouillon(etudiantID: int, formulaireID: int): Brouillon
        + creerOuMettreAJourBrouillon(etudiantID: int, formulaireID: int, reponses: Map): Brouillon
        + supprimerBrouillon(etudiantID: int, formulaireID: int): void
    }

    class Commentaire {
        - id: int
        - reponse: Reponse
        - auteur: Utilisateur
        - texte: string
        - dateCreation: Date
        - estAnonyme: boolean
        --
        + poster(): void
        + repondre(): void
    }

    class Statistiques {
        - id: int
        - enseignant: Enseignant
        - periode: Period
        - moyenneGlobale: float
        - nombreEvaluations: int
        - tendance: Tendance
        --
        + calculerMoyenne(): float
        + obtenirEvolution(): Chart
        + comparerAvecPaires(): void
    }

    class ModeleStatistiques {
        --
        + obtenirStatistiquesGlobales(): StatistiquesGlobales
        + obtenirStatistiquesParPeriode(dateDebut: Date, dateFin: Date): StatistiquesPeriodes
        + obtenirMoyennesParEnseignant(): Map<Enseignant, float>
        + obtenirEvolutionTemporelle(): EvolutionTemporelle
        + obtenirTendances(): Tendances
        + obtenirDonneesFiltrees(type: TypeStatistique, dateDebut: Date, dateFin: Date): DonneesFiltrees
        + obtenirNouvellesDonnees(): NouvellesDonnees
        + obtenirStatistiquesCompletes(): StatistiquesCompletes
        + filtrerDonnees(criteres: Map): DonneesFiltrees
    }

    class Rapport {
        - id: int
        - enseignant: Enseignant
        - dateGeneration: Date
        - periodeDebut: Date
        - periodeFin: Date
        --
        + calculerStatistiques(): void
    }

    class ModeleRapport {
        --
        + compilerDonneesRapport(parametres: Map): DonneesRapport
        + genererPDF(donnees: DonneesRapport): File
        + genererExcel(donnees: DonneesRapport): File
        + genererCSV(donnees: DonneesRapport): File
        + exporter(donnees: DonneesRapport, format: FormatExport): File
    }

    ' Relations Model
    Utilisateur <|-- Etudiant
    Utilisateur <|-- Enseignant
    Utilisateur <|-- Administrateur
    
    Formulaire "*" -- "1" Enseignant
    ModeleFormulaire ..> Formulaire : utilise
    Question "*" -- "1" Formulaire
    Evaluation "*" -- "1" Formulaire
    Evaluation "*" -- "1" Etudiant
    ModeleEvaluation ..> Evaluation : utilise
    Reponse "*" -- "1" Evaluation
    Reponse "*" -- "1" Question
    Brouillon "*" -- "1" Etudiant
    Brouillon "*" -- "1" Formulaire
    ModeleBrouillon ..> Brouillon : utilise
    Commentaire "*" -- "1" Reponse
    Commentaire "*" -- "1" Utilisateur
    Rapport "1" -- "1" Enseignant
    ModeleRapport ..> Rapport : utilise
    Statistiques "1" -- "1" Enseignant
    ModeleStatistiques ..> Statistiques : utilise
}

package "Contrôleur" {
    class ControleurAuthentification {
        - utilisateurCourant: Utilisateur
        --
        + login(email: string, password: string): boolean
        + logout(): void
        + verifierSession(): boolean
    }

    class ControleurEvaluation {
        - evaluationCourante: Evaluation
        - modeleEvaluation: ModeleEvaluation
        - modeleFormulaire: ModeleFormulaire
        - modeleBrouillon: ModeleBrouillon
        --
        + chargerFormulaire(enseignantID: int): DonneesFormulaire
        + soumettreEvaluation(formulaireID: int, reponses: Map): ResultatSoumission
        + sauvegarderBrouillon(formulaireID: int, reponsesPartielles: Map): void
        + validerEvaluation(): boolean
    }

    class ControleurTableauBord {
        - modeleStatistiques: ModeleStatistiques
        - modeleEvaluation: ModeleEvaluation
        - modeleRapport: ModeleRapport
        --
        + chargerTableauBord(): DonneesTableauBord
        + chargerTableauBord(dateDebut: Date, dateFin: Date): DonneesTableauBord
        + genererRapport(format: FormatExport, parametres: Map): File
        + actualiserDonnees(): DonneesActualisees
        + exporterDonnees(criteres: Map, format: FormatExport): File
    }

    class ControleurFormulaire {
        - modeleFormulaire: ModeleFormulaire
        --
        + creerFormulaire(): void
        + modifierFormulaire(id: int): void
        + supprimerFormulaire(id: int): void
        + ajouterQuestion(formulaire: Formulaire): void
        + previewFormulaire(id: int): void
    }

    class ControleurUtilisateurs {
        --
        + listerUtilisateurs(): List<Utilisateur>
        + creerUtilisateur(donnees: Map): void
        + modifierUtilisateur(id: int): void
        + supprimerUtilisateur(id: int): void
        + importerUtilisateurs(fichier: File): void
    }

    class ControleurRapports {
        - modeleRapport: ModeleRapport
        --
        + genererRapport(enseignantID: int, periode: Period): Rapport
        + exporterPDF(rapport: Rapport): File
        + exporterExcel(rapport: Rapport): File
        + planifierGeneration(parametres: Map): void
    }

    ' Relations Contrôleur -> Model
    ControleurEvaluation --> ModeleEvaluation
    ControleurEvaluation --> ModeleFormulaire
    ControleurEvaluation --> ModeleBrouillon
    ControleurTableauBord --> ModeleStatistiques
    ControleurTableauBord --> ModeleEvaluation
    ControleurTableauBord --> ModeleRapport
    ControleurFormulaire --> ModeleFormulaire
    ControleurRapports --> ModeleRapport
}

package "Vue" {
    class VueAuthentification {
        - formulaireLogin: Form
        --
        + afficherPageLogin(): void
        + afficherErreurAuthentification(): void
        + redirigerVersAccueil(): void
    }

    class VueEvaluation {
        - formulaire: Formulaire
        - questions: List<Question>
        - reponses: Map<Question, string>
        --
        + afficherFormulaire(formulaire: Formulaire, questions: List<Question>): void
        + afficherProgress(): void
        + validerFormatReponse(reponse: string): boolean
        + afficherValidation(): void
        + afficherConfirmation(): void
        + afficherErreurs(erreurs: List<string>): void
        + afficherBrouillonCharge(): void
    }

    class VueTableauBord {
        - graphiques: List<Chart>
        - statistiques: StatistiquesGlobales
        --
        + afficherTableauBord(donnees: DonneesTableauBord): void
        + afficherGraphiques(): void
        + afficherFiltres(): void
        + afficherStatistiques(): void
        + mettreAJourAffichage(donnees: DonneesActualisees): void
        + afficherErreur(message: string): void
        + afficherAvertissement(message: string): void
    }

    class VueGestionFormulaires {
        --
        + afficherListeFormulaires(): void
        + afficherEditeurFormulaire(): void
        + afficherPreview(): void
    }

    class VueGestionUtilisateurs {
        --
        + afficherListeUtilisateurs(): void
        + afficherEditeurUtilisateur(): void
        + afficherImportDialog(): void
    }

    class VueRapports {
        --
        + afficherListeRapports(): void
        + afficherRapport(): void
        + afficherExportOptions(): void
    }

    class VueCommentaires {
        --
        + afficherCommentaires(): void
        + afficherFormulaireReponse(): void
        + afficherNotifications(): void
    }

    ' Relations Vue -> Contrôleur
    VueAuthentification ..> ControleurAuthentification : utilise
    VueEvaluation ..> ControleurEvaluation : utilise
    VueTableauBord ..> ControleurTableauBord : utilise
    VueGestionFormulaires ..> ControleurFormulaire : utilise
    VueGestionUtilisateurs ..> ControleurUtilisateurs : utilise
    VueRapports ..> ControleurRapports : utilise
    VueCommentaires ..> ControleurEvaluation : utilise
}

' Types et Enums
class ValidationResult {
    + estValide: boolean
    + erreurs: List<string>
}

class DonneesFormulaire {
    + formulaire: Formulaire
    + questions: List<Question>
}

class ResultatSoumission {
    + succes: boolean
    + evaluationID: int
    + erreurs: List<string>
}

class DonneesTableauBord {
    + statistiques: StatistiquesGlobales
    + moyennes: Map<Enseignant, float>
    + evolution: EvolutionTemporelle
    + tendances: Tendances
}

class DonneesActualisees {
    + nouvellesDonnees: boolean
    + donnees: DonneesTableauBord
}

enum StatutEvaluation {
    BROUILLON
    EN_COURS
    SOUMISE
    FINALISEE
}

enum TypeQuestion {
    CHOIX_MULTIPLE
    TEXTE_LIBRE
    NOTE
    OUI_NON
}

enum FormatExport {
    PDF
    EXCEL
    CSV
    JSON
}

enum Role {
    ETUDIANT
    ENSEIGNANT
    ADMINISTRATEUR
}

' Relations avec les types
ControleurEvaluation ..> ValidationResult : retourne
ControleurEvaluation ..> DonneesFormulaire : retourne
ControleurEvaluation ..> ResultatSoumission : retourne
ControleurTableauBord ..> DonneesTableauBord : retourne
ControleurTableauBord ..> DonneesActualisees : retourne
Evaluation ..> StatutEvaluation : utilise
Question ..> TypeQuestion : utilise
ModeleRapport ..> FormatExport : utilise
Utilisateur ..> Role : utilise

@enduml
